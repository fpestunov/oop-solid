
https://www.kobzarev.com/programming/solid-principles/

Необходимо разделить его на несколько классов и выделить логику работы с базой и отображением в отдельные классы.
